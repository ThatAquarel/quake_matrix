<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spectrogram with Chart.js</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        canvas {
            background: #fff;
        }
    </style>
</head>
<body>

<canvas id="spectrogram" width="800" height="400"></canvas>

<script>
    const ctx = document.getElementById('spectrogram').getContext('2d');

    // Sample spectrogram data (intensities for different frequencies over time)
    const spectrogramData = [
        [30, 60, 90, 100, 80],
        [20, 50, 80, 90, 60],
        [40, 70, 100, 120, 90],
        [50, 80, 110, 140, 120],
        [60, 90, 120, 150, 130],
        [70, 100, 130, 160, 140],
        [80, 110, 140, 170, 150],
    ];

    // Flatten the data for the heatmap
    const heatmapData = [];
    for (let row of spectrogramData) {
        for (let value of row) {
            heatmapData.push(value);
        }
    }

    const labels = [...Array(spectrogramData[0].length).keys()].map(i => `F${i + 1}`); // Frequency labels
    const datasets = spectrogramData.map((row, rowIndex) => {
        return {
            label: `Time ${rowIndex + 1}`,
            data: row,
            backgroundColor: row.map(value => {
                const ratio = value / 160; // Adjust this according to your max value
                const r = Math.floor(255 * ratio);
                const g = Math.floor(255 * (1 - ratio));
                return `rgba(${r}, ${g}, 0, 1)`; // Color gradient from green to red
            }),
        };
    });

    // Create a heatmap chart
    const spectrogramChart = new Chart(ctx, {
        type: 'bar', // Use bar chart for heatmap effect
        data: {
            labels: labels,
            datasets: datasets,
        },
        options: {
            indexAxis: 'y', // Make bars horizontal
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    stacked: true,
                    title: {
                        display: true,
                        text: 'Frequency',
                    },
                },
                y: {
                    stacked: true,
                    title: {
                        display: true,
                        text: 'Time',
                    },
                },
            },
        },
    });
</script>

</body>
</html>