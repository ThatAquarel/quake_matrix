<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wave Fog Effect</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Create the scene
        const scene = new THREE.Scene();

        // Add fog to the scene
        const fogColor = 0xccccff; // Light fog color
        scene.fog = new THREE.Fog(fogColor, 5, 30); // (color, near, far)

        // Create the camera
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(fogColor); // Match the fog color with background
        document.body.appendChild(renderer.domElement);

        // Create a plane geometry (as a ground or fog layer)
        const planeGeometry = new THREE.PlaneGeometry(50, 50, 100, 100); // Size 50x50, with 100x100 segments
        const planeMaterial = new THREE.MeshBasicMaterial({ color: 0xaaaaaa, wireframe: true });
        const plane = new THREE.Mesh(planeGeometry, planeMaterial);
        plane.rotation.x = -Math.PI / 2; // Rotate to lay flat
        scene.add(plane);

        // Set the camera position
        camera.position.y = 5;
        camera.position.z = 15;

        // Wave parameters
        const waveSpeed = 0.003; // Speed of wave animation
        const waveFrequency = 2; // Frequency of the wave
        const waveAmplitude = 0.5; // Amplitude of the wave

        // Store original vertex positions for reference
        const originalPositions = plane.geometry.attributes.position.array.slice(); // Copy original positions

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);

            // Update vertex positions for wave effect
            const time = Date.now() * waveSpeed;
            const positions = plane.geometry.attributes.position.array;

            for (let i = 0; i < positions.length; i += 3) {
                const x = originalPositions[i];
                const y = originalPositions[i + 1];
                const z = originalPositions[i + 2];

                // Create a wave based on X and Z coordinates, simulating moving fog
                const wave = Math.sin(x * waveFrequency + time) + Math.cos(z * waveFrequency + time) * waveAmplitude;

                positions[i + 2] = z + wave * 0.5; // Adjust Z (height) for wave effect
            }

            // Mark position attribute as needing update
            plane.geometry.attributes.position.needsUpdate = true;

            // Render the scene
            renderer.render(scene, camera);
        }

        animate();

        // Resize handler
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>